title: 回调函数
date: 2015-9-7 21:42:25
tags: C/C++
category: 技术笔记
---
关于回调函数，知友[常溪玲](http://www.zhihu.com/people/ceiling)是这样回答的：
　　到一个商店买东西，刚好你要的东西没有货，于是你在店员那里留下了你的电话，过了几天店里有货了，~~店员就打了你的电话，然后你接到电话后就到店里去取了货~~(不是营业员打电话通知你，是营业员直接帮你买了，送到你家。　　by[傅奕然](http://www.zhihu.com/people/fu-yi-ran))。在这个例子里，你的电话号码就叫回调函数，你把电话留给店员就叫登记回调函数，店里后来有货了叫做触发了回调关联的事件，店员给你打电话叫做调用回调函数，你到店里去取货叫做响应回调事件。
<!--more-->
下面是一个回调函数的示例程序：
```C
#include <stdio.h>
typedef void(*CallbackFun)(int); //void类型的函数指针

void printWelcome(int len) //自己的实现函数要和函数指针形式相一致
{
    printf("欢迎欢迎 -- %d\n", len);
}

void printGoodbye(int len)
{
    printf("送客送客 -- %d\n", len);
}

void testfun_API(int times, CallbackFun pFun) //模拟API函数或DLL函数
{
    int i;

    for (i = 0; i < times; ++i)
    {
        pFun(i);
    }
    printf("\n我不知道你是迎客还是送客!\n\n");
}

void main(void)
{ 
    testfun_API(10, printWelcome); //call API
    testfun_API(10, printGoodbye);
    printWelcome(5);
}
```

运行结果：
![回调函数运行结果](http://7i7io5.com1.z0.glb.clouddn.com/回调.PNG)